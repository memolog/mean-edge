{"version":3,"sources":["path_recognizer.js"],"names":[],"mappings":"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","file":"angular2/src/router/path_recognizer.js","sourcesContent":["import {RegExp, RegExpWrapper, RegExpMatcherWrapper, StringWrapper, isPresent, isBlank, BaseException} from 'angular2/src/facade/lang';\nimport {Map, MapWrapper, StringMap, StringMapWrapper, List, ListWrapper} from 'angular2/src/facade/collection';\n\nimport {escapeRegex} from './url';\n\nclass StaticSegment {\n  string:string;\n  regex:string;\n  name:string;\n  constructor(string:string) {\n    this.string = string;\n    this.name = '';\n    this.regex = escapeRegex(string);\n  }\n\n  generate(params) {\n    return this.string;\n  }\n}\n\nclass DynamicSegment {\n  name:string;\n  regex:string;\n  constructor(name:string) {\n    this.name = name;\n    this.regex = \"([^/]+)\";\n  }\n\n  generate(params:StringMap) {\n    if (!StringMapWrapper.contains(params, this.name)) {\n      throw new BaseException(`Route generator for '${this.name}' was not included in parameters passed.`)\n    }\n    return StringMapWrapper.get(params, this.name);\n  }\n}\n\n\nclass StarSegment {\n  name:string;\n  regex:string;\n  constructor(name:string) {\n    this.name = name;\n    this.regex = \"(.+)\";\n  }\n\n  generate(params:StringMap) {\n    return StringMapWrapper.get(params, this.name);\n  }\n}\n\n\nvar paramMatcher = RegExpWrapper.create(\"^:([^\\/]+)$\");\nvar wildcardMatcher = RegExpWrapper.create(\"^\\\\*([^\\/]+)$\");\n\nfunction parsePathString(route:string):List {\n  // normalize route as not starting with a \"/\". Recognition will\n  // also normalize.\n  if (route[0] === \"/\") {\n    route = StringWrapper.substring(route, 1);\n  }\n\n  var segments = splitBySlash(route);\n  var results = ListWrapper.create();\n\n  for (var i=0; i<segments.length; i++) {\n    var segment = segments[i],\n      match;\n\n    if (isPresent(match = RegExpWrapper.firstMatch(paramMatcher, segment))) {\n      ListWrapper.push(results, new DynamicSegment(match[1]));\n    } else if (isPresent(match = RegExpWrapper.firstMatch(wildcardMatcher, segment))) {\n      ListWrapper.push(results, new StarSegment(match[1]));\n    } else if (segment.length > 0) {\n      ListWrapper.push(results, new StaticSegment(segment));\n    }\n  }\n\n  return results;\n}\n\nvar SLASH_RE = RegExpWrapper.create('/');\nfunction splitBySlash (url:string):List<string> {\n  return StringWrapper.split(url, SLASH_RE);\n}\n\n\n// represents something like '/foo/:bar'\nexport class PathRecognizer {\n  segments:List;\n  regex:RegExp;\n  handler:any;\n\n  constructor(path:string, handler:any) {\n    this.handler = handler;\n    this.segments = ListWrapper.create();\n\n    var segments = parsePathString(path);\n    var regexString = '^';\n\n    ListWrapper.forEach(segments, (segment) => {\n      regexString += '/' + segment.regex;\n    });\n\n    this.regex = RegExpWrapper.create(regexString);\n    this.segments = segments;\n  }\n\n  parseParams(url:string):StringMap {\n    var params = StringMapWrapper.create();\n    var urlPart = url;\n    for(var i=0; i<this.segments.length; i++) {\n      var segment = this.segments[i];\n      var match = RegExpWrapper.firstMatch(RegExpWrapper.create('/' + segment.regex), urlPart);\n      urlPart = StringWrapper.substring(urlPart, match[0].length);\n      if (segment.name.length > 0) {\n        StringMapWrapper.set(params, segment.name, match[1]);\n      }\n    }\n\n    return params;\n  }\n\n  generate(params:StringMap):string {\n    return ListWrapper.join(ListWrapper.map(this.segments, (segment) =>\n      '/' + segment.generate(params)), '');\n  }\n}\n"]}