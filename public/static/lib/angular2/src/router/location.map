{"version":3,"sources":["location.js"],"names":[],"mappings":"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","file":"angular2/src/router/location.js","sourcesContent":["import {BrowserLocation} from './browser_location';\nimport {StringWrapper} from 'angular2/src/facade/lang';\nimport {EventEmitter, ObservableWrapper} from 'angular2/src/facade/async';\n\nexport class Location {\n  _subject:EventEmitter;\n  _browserLocation:BrowserLocation;\n  _baseHref:string;\n  constructor(browserLocation:BrowserLocation) {\n    this._subject = new EventEmitter();\n    this._browserLocation = browserLocation;\n    this._baseHref = stripIndexHtml(this._browserLocation.getBaseHref());\n    this._browserLocation.onPopState((_) => this._onPopState(_));\n  }\n\n  _onPopState(_) {\n    ObservableWrapper.callNext(this._subject, {\n      'url': this.path()\n    });\n  }\n\n  path() {\n    return this.normalize(this._browserLocation.path());\n  }\n\n  normalize(url) {\n    return this._stripBaseHref(stripIndexHtml(url));\n  }\n\n  _stripBaseHref(url) {\n    if (this._baseHref.length > 0 && StringWrapper.startsWith(url, this._baseHref)) {\n      return StringWrapper.substring(url, this._baseHref.length);\n    }\n    return url;\n  }\n\n  go(url:string) {\n    var finalUrl = url[0] == '/' ? url : this._baseHref + '/' + url;\n    this._browserLocation.pushState(null, '', finalUrl);\n  }\n\n  forward() {\n    this._browserLocation.forward();\n  }\n\n  back() {\n    this._browserLocation.back();\n  }\n\n  subscribe(onNext, onThrow = null, onReturn = null) {\n    ObservableWrapper.subscribe(this._subject, onNext, onThrow, onReturn);\n  }\n}\n\n\n\nfunction stripIndexHtml(url) {\n  // '/index.html'.length == 11\n  if (url.length > 10 && StringWrapper.substring(url, url.length - 11) == '/index.html') {\n    return StringWrapper.substring(url, 0, url.length - 11);\n  }\n  return url;\n}\n"]}