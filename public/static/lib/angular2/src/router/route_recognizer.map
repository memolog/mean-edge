{"version":3,"sources":["route_recognizer.js"],"names":[],"mappings":"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","file":"angular2/src/router/route_recognizer.js","sourcesContent":["import {RegExp, RegExpWrapper, StringWrapper, isPresent} from 'angular2/src/facade/lang';\nimport {Map, MapWrapper, List, ListWrapper, StringMap, StringMapWrapper} from 'angular2/src/facade/collection';\n\nimport {PathRecognizer} from './path_recognizer';\n\nexport class RouteRecognizer {\n  names:Map<string, PathRecognizer>;\n  redirects:Map<string, string>;\n  matchers:Map<RegExp, PathRecognizer>;\n\n  constructor() {\n    this.names = MapWrapper.create();\n    this.matchers = MapWrapper.create();\n    this.redirects = MapWrapper.create();\n  }\n\n  addRedirect(path:string, target:string) {\n    MapWrapper.set(this.redirects, path, target);\n  }\n\n  addConfig(path:string, handler:any, alias:string = null) {\n    var recognizer = new PathRecognizer(path, handler);\n    MapWrapper.set(this.matchers, recognizer.regex, recognizer);\n    if (isPresent(alias)) {\n      MapWrapper.set(this.names, alias, recognizer);\n    }\n  }\n\n  recognize(url:string):List<StringMap> {\n    var solutions = [];\n    MapWrapper.forEach(this.redirects, (target, path) => {\n      //TODO: \"/\" redirect case\n      if (StringWrapper.startsWith(url, path)) {\n        url = target + StringWrapper.substring(url, path.length);\n      }\n    });\n\n    MapWrapper.forEach(this.matchers, (pathRecognizer, regex) => {\n      var match;\n      if (isPresent(match = RegExpWrapper.firstMatch(regex, url))) {\n        var solution = StringMapWrapper.create();\n        StringMapWrapper.set(solution, 'handler', pathRecognizer.handler);\n        StringMapWrapper.set(solution, 'params', pathRecognizer.parseParams(url));\n\n        //TODO(btford): determine a good generic way to deal with terminal matches\n        if (url == '/') {\n          StringMapWrapper.set(solution, 'matchedUrl', '/');\n          StringMapWrapper.set(solution, 'unmatchedUrl', '');\n        } else {\n          StringMapWrapper.set(solution, 'matchedUrl', match[0]);\n          var unmatchedUrl = StringWrapper.substring(url, match[0].length);\n          StringMapWrapper.set(solution, 'unmatchedUrl', unmatchedUrl);\n        }\n        ListWrapper.push(solutions, solution);\n      }\n    });\n\n    return solutions;\n  }\n\n  hasRoute(name:string) {\n    return MapWrapper.contains(this.names, name);\n  }\n\n  generate(name:string, params:any) {\n    var pathRecognizer = MapWrapper.get(this.names, name);\n    return pathRecognizer.generate(params);\n  }\n}\n"]}