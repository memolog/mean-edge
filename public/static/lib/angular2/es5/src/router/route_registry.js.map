{"version":3,"sources":["route_registry.js"],"names":[],"mappings":"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","file":"src/router/route_registry.js","sourceRoot":"/Users/yamaguchi/Desktop/mean-edge/node_modules/angular2/es6/dev/","sourcesContent":["import {RouteRecognizer} from './route_recognizer';\nimport {Instruction,\n  noopInstruction} from './instruction';\nimport {List,\n  ListWrapper,\n  Map,\n  MapWrapper,\n  StringMap,\n  StringMapWrapper} from 'angular2/src/facade/collection';\nimport {isPresent,\n  isBlank,\n  isType,\n  StringWrapper,\n  BaseException} from 'angular2/src/facade/lang';\nimport {RouteConfig} from './route_config_impl';\nimport {reflector} from 'angular2/src/reflection/reflection';\nexport class RouteRegistry {\n  constructor() {\n    this._rules = MapWrapper.create();\n  }\n  config(parentComponent, config) {\n    if (!StringMapWrapper.contains(config, 'path')) {\n      throw new BaseException('Route config does not contain \"path\"');\n    }\n    if (!StringMapWrapper.contains(config, 'component') && !StringMapWrapper.contains(config, 'components') && !StringMapWrapper.contains(config, 'redirectTo')) {\n      throw new BaseException('Route config does not contain \"component,\" \"components,\" or \"redirectTo\"');\n    }\n    var recognizer;\n    if (MapWrapper.contains(this._rules, parentComponent)) {\n      recognizer = MapWrapper.get(this._rules, parentComponent);\n    } else {\n      recognizer = new RouteRecognizer();\n      MapWrapper.set(this._rules, parentComponent, recognizer);\n    }\n    config = normalizeConfig(config);\n    if (StringMapWrapper.contains(config, 'redirectTo')) {\n      recognizer.addRedirect(StringMapWrapper.get(config, 'path'), StringMapWrapper.get(config, 'redirectTo'));\n      return ;\n    }\n    var components = StringMapWrapper.get(config, 'components');\n    StringMapWrapper.forEach(components, (component, _) => {\n      this.configFromComponent(component);\n    });\n    recognizer.addConfig(config['path'], config, config['as']);\n  }\n  configFromComponent(component) {\n    if (!isType(component)) {\n      return ;\n    }\n    if (MapWrapper.contains(this._rules, component)) {\n      return ;\n    }\n    var annotations = reflector.annotations(component);\n    if (isPresent(annotations)) {\n      for (var i = 0; i < annotations.length; i++) {\n        var annotation = annotations[i];\n        if (annotation instanceof RouteConfig) {\n          ListWrapper.forEach(annotation.configs, (config) => {\n            this.config(component, config);\n          });\n        }\n      }\n    }\n  }\n  recognize(url, parentComponent) {\n    var componentRecognizer = MapWrapper.get(this._rules, parentComponent);\n    if (isBlank(componentRecognizer)) {\n      return null;\n    }\n    var solutions = componentRecognizer.recognize(url);\n    for (var i = 0; i < solutions.length; i++) {\n      var candidate = solutions[i];\n      if (candidate['unmatchedUrl'].length == 0) {\n        return handlerToLeafInstructions(candidate, parentComponent);\n      }\n      var children = StringMapWrapper.create(),\n          allMapped = true;\n      StringMapWrapper.forEach(candidate['handler']['components'], (component, name) => {\n        if (!allMapped) {\n          return ;\n        }\n        var childInstruction = this.recognize(candidate['unmatchedUrl'], component);\n        if (isPresent(childInstruction)) {\n          childInstruction.params = candidate['params'];\n          children[name] = childInstruction;\n        } else {\n          allMapped = false;\n        }\n      });\n      if (allMapped) {\n        return new Instruction({\n          component: parentComponent,\n          children: children,\n          matchedUrl: candidate['matchedUrl']\n        });\n      }\n    }\n    return null;\n  }\n  generate(name, params, hostComponent) {\n    var componentRecognizer = MapWrapper.get(this._rules, hostComponent);\n    if (isPresent(componentRecognizer)) {\n      return componentRecognizer.generate(name, params);\n    }\n  }\n}\nObject.defineProperty(RouteRegistry.prototype.recognize, \"parameters\", {get: function() {\n    return [[assert.type.string], []];\n  }});\nObject.defineProperty(RouteRegistry.prototype.generate, \"parameters\", {get: function() {\n    return [[assert.type.string], [assert.type.any], []];\n  }});\nfunction handlerToLeafInstructions(context, parentComponent) {\n  var children = StringMapWrapper.create();\n  StringMapWrapper.forEach(context['handler']['components'], (component, outletName) => {\n    children[outletName] = new Instruction({\n      component: component,\n      params: context['params']\n    });\n  });\n  return new Instruction({\n    component: parentComponent,\n    children: children,\n    matchedUrl: context['matchedUrl']\n  });\n}\nfunction normalizeConfig(config) {\n  if (StringMapWrapper.contains(config, 'component')) {\n    var component = StringMapWrapper.get(config, 'component');\n    var components = StringMapWrapper.create();\n    StringMapWrapper.set(components, 'default', component);\n    var newConfig = StringMapWrapper.create();\n    StringMapWrapper.set(newConfig, 'components', components);\n    StringMapWrapper.forEach(config, (value, key) => {\n      if (!StringWrapper.equals(key, 'component') && !StringWrapper.equals(key, 'components')) {\n        StringMapWrapper.set(newConfig, key, value);\n      }\n    });\n    return newConfig;\n  }\n  return config;\n}\nObject.defineProperty(normalizeConfig, \"parameters\", {get: function() {\n    return [[StringMap]];\n  }});\n//# sourceMappingURL=route_registry.js.map\n\n//# sourceMappingURL=./route_registry.map"]}